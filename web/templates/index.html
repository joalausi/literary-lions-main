{{define "index.html"}}
{{template "base.html" .}}
{{end}}

{{define "content"}}
  <div class="card">
    <form method="get" action="/" class="grid">
      <div class="row">
        <label for="cat">Filter by category</label>
        <select id="cat" name="cat">
          <option value="">-- All --</option>
          {{range .Categories}}
            <option value="{{.ID}}" {{if eq (printf "%d" .ID) $.FilterCat}}selected{{end}}>{{.Name}}</option>
          {{end}}
        </select>
      </div>
      <div class="row actions">
        <label><input type="checkbox" name="mine" value="1" {{if .FilterMine}}checked{{end}}> My posts</label>
        <label><input type="checkbox" name="liked" value="1" {{if .FilterLiked}}checked{{end}}> Liked by me</label>
        <button class="btn primary" type="submit">Apply</button>
        <a class="btn" href="/">Reset</a>
      </div>
    </form>
  </div>

  <div class="spacer"></div>

  <div class="grid">
    {{if .Posts}}
      {{range .Posts}}
        <article class="card">
          <header class="row" style="justify-content:space-between">
            <h2 style="margin:0"><a href="/post?id={{.ID}}">{{.Title}}</a></h2>
            <span class="muted row" style="gap:6px">
              {{if .AvatarPath}}<img class="avatar-sm" src="{{.AvatarPath}}" alt="av">{{end}}
              <a href="/u/{{.Username}}">{{.Username}}</a> Â· {{.CreatedAt}}
            </span>
          </header>
          {{if .Cats}}
            <div class="muted">Categories: {{.Cats}}</div>
          {{end}}
          <div class="actions">
            <a class="btn" href="/post?id={{.ID}}">Open</a>
          </div>
        </article>
      {{end}}
    {{else}}
      <div class="card">No posts yet. Be the first to <a href="/posts/new">create one</a>!</div>
    {{end}}
  </div>
{{end}}
